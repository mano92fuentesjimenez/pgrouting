  BEGIN;
  BEGIN
  SET client_min_messages TO NOTICE;
  SET
  create table lineal_groups(
    layer_name text,
    group_id int 
                 
                 
                 
  );
  CREATE TABLE
  create table point_groups(
    
    
    point_layer_name text,
    lineal_layer_name text
  );
  CREATE TABLE
  create table layers_info(
    layer_name text,
    layer text,  
    conn_policy integer, 
                         
                         
                         
                               
                         
                         
                         
                              
                              
    z integer  
               
               
               
  );
  CREATE TABLE
  create table lineal_layer (
    id integer,
    geom geometry,
    z_start float,
    z_end float
  );
  CREATE TABLE
  create table point_layer (
    id integer,
    geom geometry,
    z float
  );
  CREATE TABLE
  drop table test_table_l1;
  ERROR:  table "test_table_l1" does not exist
  create table test_table_l1(
    geom geometry( 'linestringz ',4326),
    id integer primary key,
    z_start float default 0,
    z_end float default 0
  );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_l1 VALUES ( 'SRID=4326;linestring(5 0 0,10 10 0, 13 10 0, 15 10 0) ',1);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_l1 VALUES ( 'SRID=4326;linestring(0 0 0, 10 10 0) ',2);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_l1 VALUES ( 'SRID=4326;linestring(10 10 0, 10 0 0) ',3);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_l1 VALUES ( 'SRID=4326;linestring(8 0 0, 10 10 0) ',4);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_l1 VALUES ( 'SRID=4326;linestring(8 0 0, 8 10 0, 10 10 0) ', 5);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_l1 values ( 'SRID=4326;linestring(7 12 0, 13 10 0, 14 8 0) ', 6);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_l1 values ( 'SRID=4326;linestring(15 14 50, 15 10 50, 15 8 50) ', 7);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_l1 values ( 'SRID=4326;linestring(15 16 35, 15 14 50) ', 8);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_l1 values ( 'SRID=4326;linestring(13 16 35, 15 14 50, 13 14 50) ', 9);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  drop table test_table_l2;
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  create table test_table_l2(
    geom geometry( 'linestringz ',4326),
    id integer primary key,
    z_start float default 0,
    z_end float default 0
  );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_l2 values ( 'SRID=4326;linestring(13 18 35, 13 16 35, 7 12 0) ', 1);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_l2 values ( 'SRID=4326;linestring(15 18 0, 15 16 35, 17 18 0) ', 2);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  drop table test_table_p1;
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  create TABLE test_table_p1(
    geom geometry( 'pointz ',4326),
    id integer primary key,
    z float default 0
  );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_p1 values( 'SRID=4326;point(10 10 0) ',1);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_p1 values( 'SRID=4326;point(10 0 0) ',2);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_p1 values( 'SRID=4326;point(8 10 0) ',3);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_p1 values( 'SRID=4326;point(8 0 0) ',4);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_p1 values( 'SRID=4326;point(5 0 0) ',5);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_p1 values( 'SRID=4326;point(0 0 0) ',6);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_p1 values( 'SRID=4326;point(7 12 0) ',7);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_p1 values( 'SRID=4326;point(15 10 0) ',8);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_p1 values( 'SRID=4326;point(13 14 50) ',9);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_p1 values( 'SRID=4326;point(15 16 35) ',10);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_p1 values( 'SRID=4326;point(15 8 50) ',11);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_p1 values( 'SRID=4326;point(14 8 0) ',12);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_p1 values( 'SRID=4326;point(13 18 35) ',13);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into test_table_p1 values( 'SRID=4326;point(15 18 0) ',14);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into lineal_groups values( 'linealLayer-1 ',1),( 'linealLayer-2 ',2);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into point_groups values( 'pointLayer-1 ', 'linealLayer-1 '),( 'pointLayer-1 ', 'linealLayer-2 ');
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  insert into layers_info values( 'linealLayer-1 ', 'select id, geom, z_start, z_end from test_table_l1 ',1,0),
                                ( 'linealLayer-2 ', 'select id, geom, z_start, z_end from test_table_l2 ',1,0),
                                ( 'pointLayer-1 ', 'select id, geom, z from test_table_p1 ',1,0);
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  SELECT count(*) from  pgr_createtopology_multimodal(
     'select * from lineal_groups ',
     'select * from point_groups ',
     'select * from layers_info ',
     'graph_lines ',
     'public ',
    0.000001
  );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  select count(*) from pgr_dijkstra(
      'select id, source, target, 0 as cost, 0 as reverse_cost from graph_l ' ||
      'ines ',
     (select id from graph_lines_pt where id_geom =6 ),
     (select id from graph_lines_pt where id_geom =4 )
  );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  select count(*) from pgr_dijkstra(
      'select id, source, target, 0 as cost, 0 as reverse_cost from graph_lines ',
     (select id from graph_lines_pt where id_geom =6 ),
     (select id from graph_lines_pt where id_geom =2 )
  );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  select count(*) from pgr_dijkstra(
      'select id, source, target, 0 as cost, 0 as reverse_cost from graph_lines ',
     (select id from graph_lines_pt where id_geom =6 ),
     (select id from graph_lines_pt where id_geom =5 )
   );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  select count(*) from graph_lines_pt where id_geom = 3;
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  select count(*) from pgr_dijkstra(
      'select id, source, target, 0 as cost, 0 as reverse_cost from graph_lines ',
     (select id from graph_lines_pt where id_geom =2 ),
     (select id from graph_lines_pt where id_geom =3 )
   );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  select count(*) from pgr_dijkstra(
      'select id, source, target, 0 as cost, 0 as reverse_cost from graph_lines ',
     (select id from graph_lines_pt where id_geom =7 ),
     (select id from graph_lines_pt where id_geom =5 )
   );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  select count(*) from pgr_dijkstra(
      'select id, source, target, 0 as cost, 0 as reverse_cost from graph_lines ',
     (select id from graph_lines_pt where id_geom =7 ),
     (select id from graph_lines_pt where id_geom =6 )
   );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  select count(*) from pgr_dijkstra(
      'select id, source, target, 0 as cost, 0 as reverse_cost from graph_lines ',
     (select id from graph_lines_pt where id_geom =11 ),
     (select id from graph_lines_pt where id_geom =1 )
  );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  select count(*) from pgr_dijkstra(
      'select id, source, target, 0 as cost, 0 as reverse_cost from graph_lines ',
     (select id from graph_lines_pt where id_geom =11 ),
     (select id from graph_lines_pt where id_geom =9 )
   );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  select count(*) from pgr_dijkstra(
      'select id, source, target, 0 as cost, 0 as reverse_cost from graph_lines ',
     (select id from graph_lines_pt where id_geom =10 ),
     (select id from graph_lines_pt where id_geom =9 )
   );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  select count(*) from pgr_dijkstra(
      'select id, source, target, 0 as cost, 0 as reverse_cost from graph_lines ',
     (select id from graph_lines_pt where id_geom =13 ),
     (select id from graph_lines_pt where id_geom =12 )
   );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  select count(*) from pgr_dijkstra(
      'select id, source, target, 0 as cost, 0 as reverse_cost from graph_lines ',
     (select id from graph_lines_pt where id_geom =13 ),
     (select id from graph_lines_pt where id_geom =9 )
   );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  select count(*) from pgr_dijkstra(
      'select id, source, target, 0 as cost, 0 as reverse_cost from graph_lines ',
     (select id from graph_lines_pt where id_geom =14 ),
     (select id from graph_lines_pt where id_geom =9 )
  );
  ERROR:  current transaction is aborted, commands ignored until end of transaction block
  ROLLBACK;
  ROLLBACK